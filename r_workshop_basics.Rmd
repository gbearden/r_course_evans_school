---
title: "R Basics"
author: Graham Bearden
date: January 10, 2017
output: 
  slidy_presentation:
    css: custom.css
---

```{r load_packages, include=FALSE}
library(tidyverse)

donor <- read_csv('data/small_donations_data.csv')
police <- read_csv('data/small_police_data.csv')

```

----

# First things first

- Set up your machine to run R
  - Install R ([on a Mac](https://cran.rstudio.com/bin/macosx/R-3.4.3.pkg) and [on a PC](https://cran.rstudio.com/bin/windows/base/R-3.4.3-win.exe))
  - Install R Studio ([on a Mac](https://download1.rstudio.org/RStudio-1.1.383.dmg) and [on a PC](https://download1.rstudio.org/RStudio-1.1.383.exe))
- Make sure you can install packages
  - 2 ways to install packages
    - **Command line**
    - R Studio GUI
```r
install.packages('devtools')
```

----

# First things first

- Set up your machine to run R
  - Install R ([on a Mac](https://cran.rstudio.com/bin/macosx/R-3.4.3.pkg) and [on a PC](https://cran.rstudio.com/bin/windows/base/R-3.4.3-win.exe))
  - Install R Studio ([on a Mac](https://download1.rstudio.org/RStudio-1.1.383.dmg) and [on a PC](https://download1.rstudio.org/RStudio-1.1.383.exe))
- Make sure you can install packages
  - 2 ways to install packages
    - Command line
    - **R Studio GUI**
  
![](figures/r_studio_install_packages.png){ width=50% }

----

# Some things you should know

- Mental models and programming
  - Excel/SPSS/Stata --> R/Python/Go/Julia
- What all R programmers do
  - Google for answers
  - Borrow code
  - Ask friends and pros for help
- Useful references (see Reference Materials in the Syllabus for more)
  - help()
  - ??
  - [R Bloggers](https://www.r-bloggers.com/)
  - [stackoverflow](https://stackoverflow.com/documentation/r/topics)
  
----

# Quick Tour of R Studio

----

# <span style="color:#6DA34D">Functions</span>, libraries, data

- Functions perform operations in R
```r
foo <- c(1,2,4)
foo %>% min()
foo %>% mean()
foo %>% max()
foo %>% sd()
```

- Function arguments
  - Arguments are inputs
  
```r
cat_function <- function(love=TRUE){
    if(love==TRUE){
        print("I love cats!")
    }
    else {
        print("I am not a cool person.")
    }
}
```

```r
min <- function(vector_of_values, na.rm=TRUE)
```

<!-- <div style="position: fixed; top: 0; right: 1000;"> -->
<!-- ![](figures/operators.png){ width=40% } -->
<!-- </div> -->

----

# <span style="color:#6DA34D">Functions</span>, libraries, data

```r
foo <- c(1,2,NA, 4)
foo %>% min()
foo %>% mean()
foo %>% max()
foo %>% sd()
```

----

# <span style="color:#6DA34D">Functions</span>, libraries, data

```{r, echo = TRUE, collapse=TRUE}
foo <- c(1,2,NA, 4)
foo %>% min()
foo %>% mean()
foo %>% max()
foo %>% sd()
```

----

# <span style="color:#6DA34D">Functions</span>, libraries, data

```{r, echo = TRUE, collapse=TRUE}
foo <- c(1,2,NA, 4)
min(foo, na.rm = TRUE)
mean(foo, na.rm = TRUE)
max(foo, na.rm = TRUE)
sd(foo, na.rm = TRUE)
```

----

# Functions, <span style="color:#6DA34D">libraries</span>, data

- Libraries (or packages) are collections of functions (and datasets)
- Over 10,000 libraries on CRAN

```r
library(tidyverse)
install.packages('tidyverse')
install.packages(c('tidyverse', 'readxl', 'rmarkdown'))
```

----

# Functions, libraries, <span style="color:#6DA34D">data</span>

- Oh my, so many types of data!
  - Data frames, matrices, vectors
  - Integers, numbers, characters, factors
- Confirm data type
```{r, echo = TRUE, collapse=TRUE}
c('foo', 'moo', 'boo') %>% class()
c('foo', 'moo', 'boo') %>% is.character()
c('foo', 'moo', 'boo') %>% is.factor()
```
- Coerce data type
```{r, echo = TRUE, collapse=TRUE}
c('foo', 'moo', 'boo') %>% as.factor()
c('foo', 'moo', 'boo') %>% as.factor() %>% class()
```

----

# Functions, libraries, <span style="color:#6DA34D">data</span>

- Oh my, so many types of data!
  - **Data frames**, matrices, vectors
- Data frames look a little like spreadsheets
```{r, echo = TRUE, collapse=TRUE}
data_frame(x = c(1:3), y = c(4:6), z = c('foo', 'boo', 'moo'))
```
- Call a specific variable by name or location in the data frame
  - df$variable
```r
cars$speed
cars[,1]
```

----

# Functions, libraries, <span style="color:#6DA34D">data</span>

- Oh my, so many types of data!
  - **Data frames**, matrices, vectors
- Data frames look a little like spreadsheets
```{r, echo = TRUE, collapse=TRUE}
data_frame(x = c(1:3), y = c(4:6), z = c('foo', 'boo', 'moo'))
```

- Call a specific variable by name or location in the data frame
  - df$variable
  
```{r, echo = TRUE, collapse=TRUE}
cars$speed
cars[,1]
```

----

# Functions, libraries, <span style="color:#6DA34D">data</span>

- Oh my, so many types of data!
  - Data frames, **matrices**, vectors
- Matrices and data frames have similar shapes
- Matrices contains data of a single type

```{r, echo = TRUE, collapse=TRUE}
matrix(data = 1:6, nrow = 3, ncol = 2)
```

----

# Functions, libraries, <span style="color:#6DA34D">data</span>

- Oh my, so many types of data!
  - Data frames, matrices, **vectors**
- Vectors contain 1 or more values in a string
```{r, echo = TRUE, collapse=TRUE}
c('foo', 'moo', 'boo')
1:10
rep(1:2, times = 2)
rep(c(1,2), times = 2)
seq(from = 0, to = 100, by = 10)
seq(0, 100, 10)
cars$speed
```

-----

# Functions, libraries, <span style="color:#6DA34D">data</span>

- Oh my, so many types of data!
  - Data frames, matrices, **vectors**
- Call a specific element by its location in a vector
```r
c('foo', 'moo', 'boo')[2]
seq(from = 0, to = 100, by = 10)[6]
```

-----

# Functions, libraries, <span style="color:#6DA34D">data</span>

- Oh my, so many types of data!
  - Data frames, matrices, **vectors**
- Call a specific element by its location in a vector
```{r, echo = TRUE, collapse=TRUE}
c('foo', 'moo', 'boo')[2]
seq(from = 0, to = 100, by = 10)[6]
```

----

# Let's apply what we learned to real data

<div class="column-left">
Import the small donations dataset in R Studio
```r
getwd()
setwd()
donor <- read_csv('data/small_donations_data.csv')
```
</div>

----

# Let's apply what we learned to real data

<div class="column-left">
Import the small donations dataset in R Studio
```r
getwd()
setwd()
donor <- read_csv('data/small_donations_data.csv')
```
</div>

<div class="column-right-questions">
Questions<br>
What type of object is `donor`?<br>
What are the `min()` and `mean()` for `amount`?<br>
What is the `max()` for `legislative_district`?
</div>

----

# Let's apply what we learned to real data

<div class="column-left">
Import the small donations dataset in R Studio
```r
getwd()
setwd()
donor <- read_csv('data/small_donations_data.csv')
```

```{r, echo = TRUE, collapse=TRUE}
donor %>% class()
donor$amount %>% min()
donor$amount %>% mean()
donor$legislative_district %>% max(na.rm = TRUE)
```
</div>

<div class="column-right-questions">
Questions<br>
What type of object is `donor`?<br>
What are the `min()` and `mean()` for `amount`?<br>
What is the `max()` for `legislative_district`?
</div>

----

# Base R functions to explore your data
- Get in the habit of running these functions when you open a new dataset
  - `head()` shows you the top subset of a data in a data frame
    - Number of rows is a `head()` argument and defaults at 5
    - `tail()` shows the bottom subset of data in a data frame
  - `summary()` shows summary statistics on all variabes in a dataset
    - Reported summary statistics depend on the variable type
  - `ls()` shows all variables in a data frame
    - You can also use `ls()` without calling an object between the parentheses to see all objects in your workspace
  - `str()` tells the variable type and selected variable values in a data frame for all variables
  - `dim()` tells you the dimensions of your dataset
    - `nrow()` reports the number of rows only 
    - `ncol()` reports the number of columns only

----

# Base R functions to explore your data

<div class="column-left">
- Get in the habit of running these functions when you open a new dataset
  - `head()` shows you the top subset of a data in a data frame
    - Number of rows is a `head()` argument and defaults at 5
    - `tail()` shows the bottom subset of data in a data frame
  - `summary()` shows summary statistics on all variabes in a dataset
    - Reported summary statistics depend on the variable type
  - `ls()` shows all variables in a data frame
    - You can also use `ls()` without calling an object between the parentheses to see all objects in your workspace
  - `str()` tells the variable type and selected variable values in a data frame for all variables
  - `dim()` tells you the dimensions of your dataset
    - `nrow()` reports the number of rows only 
    - `ncol()` reports the number of columns only
</div>

<div class="column-right-questions">
Questions<br>
How many row and columns are in `donor`?<br>
What is the median value for `amount`?<br>
How many variables are in `donor`?<br>
<i>Hint: There are multiple ways to answers these questions with the functions you know</i>
</div>

----

# Base R functions to explore your data

<div class="column-left">
```{r, echo = TRUE, collapse=TRUE}
donor %>% dim()
donor$amount %>% median(na.rm = TRUE)
donor %>% ncol()
```

Other methods to answer questions
```r
donor %>% summary()
donor %>% ls()
```
</div>

<div class="column-right-questions">
Questions<br>
How many row and columns are in `donor`?<br>
What is the median value for `amount`?<br>
How many variables are in `donor`?<br>
<i>Hint: There are multiple ways to answers these questions with the functions you know</i>
</div>

----

# Base R functions to explore vectors
- `table()` shows you the distribution of values in a vector
- `length()` tells you in the number of elements in a vector
- `unique()` shows you the unique values in a vector
- `summary()` shows you descriptive statistics for a vector
  - `summary()` can run on a vector or data frame

----

# Base R functions to explore vectors

<div class="column-left">
- `table()` shows you the distribution of values in a vector
- `length()` tells you in the number of elements in a vector
- `unique()` shows you the unique values in a vector
- `summary()` shows you descriptive statistics for a vector
  - `summary()` can run on a vector or data frame
</div>

<div class="column-right-questions">
Questions<br>
How many 'DEMOCRAT' values are there in `party`?<br>
Which value in `contributor_employer_state` is most frequent?<br>
Is 'Mayoral Race' a `type` value?<br>
How many distinct `first_name` values are there?<br>
<i>Hint: There are multiple ways to answers these questions with the functions you know</i>
</div>

----

# Base R functions to explore vectors

<div class="column-left">
```{r, echo = TRUE, collapse=TRUE}
table(donor$party)
table(donor$contributor_employer_state)
donor$type %>% unique()
donor$first_name %>% unique() %>% length()
```
</div>

<div class="column-right-questions">
Questions<br>
How many 'DEMOCRAT' values are there in `party`?<br>
Which value in `contributor_employer_state` is most frequent?<br>
Is 'Mayoral Race' a `type` value?<br>
How many distinct `first_name` values are there?<br>
<i>Hint: There are multiple ways to answers these questions with the functions you know</i>
</div>

----

# Practice with police data

<div class="column-left">
Import the small police dataset in R Studio
```r
getwd()
setwd()
donor <- read_csv('data/small_police_data.csv')
```
</div>

<div class="column-right-questions">
Questions<br>
How many rows and columns are there in `police`?<br>
What is the most recent `event_clearance_date`?<br>
Which `district_sector` sees the most incident activity?<br>
How many 'RECKLESS BURNING' incidence are there in `event_clearance_subgroup`?<br>
What is the smallest `census_tract` value? 
</div>

----

# Practice with police data

<div class="column-left">
Import the small police dataset in R Studio
```{r, echo = TRUE, collapse=TRUE}
police %>% dim()
police$event_clearance_date %>% max(na.rm = TRUE)
table(police$district_sector)
```
</div>

<div class="column-right-questions">
Questions<br>
How many rows and columns are there in `police`?<br>
What is the most recent `event_clearance_date`?<br>
Which `district_sector` sees the most incident activity?<br>
How many 'RECKLESS BURNING' incidence are there in `event_clearance_subgroup`?<br>
What is the smallest `census_tract` value? 
</div>

----

# Practice with police data

<div class="column-left">
Import the small police dataset in R Studio
```{r, echo = TRUE, collapse=TRUE}
police$event_clearance_subgroup %>% 
  table() %>% 
  as.data.frame() %>% 
  .[32:35,]
```
</div>

<div class="column-right-questions">
Questions<br>
How many rows and columns are there in `police`?<br>
What is the most recent `event_clearance_date`?<br>
Which `district_sector` sees the most incident activity?<br>
How many 'RECKLESS BURNING' incidence are there in `event_clearance_subgroup`?<br>
What is the smallest `census_tract` value? 
</div>

----

# Practice with police data

<div class="column-left">
Import the small police dataset in R Studio
```{r, echo = TRUE, collapse=TRUE}
police$census_tract %>% 
  as.integer() %>% 
  min(na.rm = TRUE)
```
</div>

<div class="column-right-questions">
Questions<br>
How many rows and columns are there in `police`?<br>
What is the most recent `event_clearance_date`?<br>
Which `district_sector` sees the most incident activity?<br>
How many 'RECKLESS BURNING' incidence are there in `event_clearance_subgroup`?<br>
What is the smallest `census_tract` value? 
</div>

----

# Troubleshooting your R code

----

# Anatomy of an R script

----

# Anatomy of a function


# R basics

- Loops
  - *for()* and *while()*

----

# Pandoc installation

----

# Miktek installation

----

# Note on datasets in the course

