<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Part 4 - More data visualization and data processing + Agent Mode in VS Code</title>
    <meta charset="utf-8" />
    <meta name="author" content="Graham Bearden" />
    <meta name="date" content="2025-10-30" />
    <script src="libs/header-attrs-2.29/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis-fonts.css" rel="stylesheet" />
    <link href="libs/countdown-0.4.0/countdown.css" rel="stylesheet" />
    <script src="libs/countdown-0.4.0/countdown.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Part 4 - More data visualization and data processing + Agent Mode in VS Code
]
.author[
### Graham Bearden
]
.institute[
### University of Washington
]
.date[
### October 30, 2025
]

---


&lt;style type="text/css"&gt;
.small { font-size: 90% }
.smaller { font-size: 80% }
&lt;/style&gt;



# Housekeeping

- Reminder: Submit 2 “stakeholder-ready” data visualizations and your code on November 3 or before  
  - The assignment has been added to Canvas
  - See examples [here](https://github.com/gbearden/r_course_evans_school/blob/master/plots/) on Github  
- What does "Stakeholder-ready" mean?  
  - Write a plot title
  - Label the axes 
  - Use a theme
  - Do not include `NA`s in the plot (geom or legend)  
- Datasets  
  - [Kaggle](https://www.kaggle.com/datasets)
  - [Data.gov](https://www.data.gov/)
  - [Washington Post](https://github.com/orgs/washingtonpost/repositories?language=&amp;q=data&amp;sort=&amp;type=)
  - [fivethirtyeight](https://data.fivethirtyeight.com/)  
  - [Awesome Public Datasets on Github](https://github.com/awesomedata/awesome-public-datasets)
  - [BuzzFeed](https://github.com/BuzzFeedNews)  
  - [Google Dataset Search](https://datasetsearch.research.google.com/)
  - BONUS dataset: [Great British Bakeoff](https://github.com/apreshill/bakeoff)  

---

# Housekeeping

- Stay in touch! 
  - Feel free to connect with me on LinkedIn
  - Discussing data science/analytics careers

**Data for class**  
```r
airbnb &lt;- read_csv('https://bit.ly/3oadz2L')
climate &lt;- read_csv('https://bit.ly/3kKErEb')
mba &lt;- read_csv("https://bit.ly/4evYpeW")
```

---

# What we learned in the previous class

- Running code in an R Notebook 
- Overview of ggplot2  
- Building bar plots
  - Aggregated data
  - Disaggregated data
- Customizing plots
  - Adding themes, titles, and scales to plots

---

# What we'll learn today  

- Build line and scatter plots  
- Creating multi-geom (line and bar) plot
- Creating population pyramid
- Pivoting data
- Agent Mode in VS Code

---

# A few reminders

- Run code line by line  
- Ensure the code finished running (`+`s vs. `&gt;`s in the R console)  
- Red "x" annotation beside line numbers (after saving your file)

![](./figures/red_x_example.png)

---

# A few reminders

```r
# Example 1 - use %in% when filtering on a string in the function
climate %&gt;% 
  filter(country %in% c('Brazil', 'China', 'India', 'Turkey', 'United States'))

# Examples 2 &amp; 3 - use %in% or == when filtering on a character string variable
countries &lt;- c('Brazil', 'China', 'India', 'Turkey', 'United States')
climate %&gt;% 
  filter(country %in% countries)

climate %&gt;% 
  filter(country == countries)

# Example 4 - use == to filter on a single value
climate %&gt;% 
  filter(country == "Brazil")

```

---

# A few reminders

```r
# stat = "count"
airbnb %&gt;% 
  ggplot(
    aes(
      x = address,
      fill = address
      )
    ) + 
  geom_bar()
  
# stat = "identity"
airbnb %&gt;% 
  group_by(address) %&gt;% 
  summarise(count = n()) %&gt;%
  ggplot(
    aes(
      x = address,
      y = count,
      fill = address
      )
    ) + 
  geom_bar(stat = 'identity')
```

---

# Warm up Exercise - MBA admissions

Create a stacked bar plot from the UPenn MBA admissions data that shows the number of non-international students by work industry. 

- Stacked bar segments should be mapped to a new variable that indicates whether a GMAT score is high or low. You can decide the threshold for what's "high" and "low"
- Use `reorder()` to sort the bars. Remember that when sorting (or reordering) bars you need to aggregate the data with `group_by()` and `summarise()` before creating the plot  
- Don't forget to use `filter()` to exclude international students 
- Update plot and axis titles and use a theme if you have time

```r
mba &lt;- read_csv("https://bit.ly/4evYpeW")
```

--

```r
mba %&gt;%
  filter() %&gt;% # remove international students from the tibble
  mutate() %&gt;% # create a new variable indicating whether the GMAT score is high/low
  group_by() %&gt;% # group on character variables mapped to an axis and fill
  summarise() %&gt;% # count applications
  ggplot() + 
  geom_bar()
```

<div class="countdown" id="timer_1b2a9a2d" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">07</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

# Warm up Exercise - MBA admissions

Create a stacked bar plot from the UPenn MBA admissions data that shows the number of non-international students by work industry. 

![](index_files/figure-html/unnamed-chunk-3-1.png)&lt;!-- --&gt;

---

# Warm up Exercise - MBA admissions

Create a stacked bar plot from the UPenn MBA admissions data that shows the number of non-international students by work industry. 

```r
mba %&gt;%
  filter(international == FALSE) %&gt;% 
  mutate(high_gmat = if_else(gmat &gt; 650, "High GMAT Score", "Low GMAT Score")) %&gt;% 
  group_by(work_industry, high_gmat) %&gt;% 
  summarise(n = n())  
```

---

# Warm up Exercise - MBA admissions

Create a stacked bar plot from the UPenn MBA admissions data that shows the number of non-international students by work industry. 

```r
mba %&gt;%
  filter(international == FALSE) %&gt;% 
  mutate(high_gmat = if_else(gmat &gt; 650, "High GMAT Score", "Low GMAT Score")) %&gt;% 
  group_by(work_industry, high_gmat) %&gt;% 
  summarise(n = n()) %&gt;% 
  ggplot(aes(y = reorder(work_industry, n), x = n, fill = high_gmat)) +
  geom_bar(stat = "identity") + 
  labs(fill = NULL) + 
  theme_fivethirtyeight() + 
  scale_fill_fivethirtyeight()
```

--

How do you turn this plot into a population pyramid style plot?

---

# Warm up Exercise - MBA admissions


``` r
  mba %&gt;%
    filter(international == FALSE) %&gt;% 
    mutate(high_gmat = if_else(gmat &gt; 650, "High GMAT Score", "Low GMAT Score")) %&gt;% 
    group_by(work_industry, high_gmat) %&gt;% 
    summarise(n = n()) %&gt;% 
*   mutate(
*     industry_n = sum(n),
*     n = if_else(high_gmat == "Low GMAT Score", n * -1, n)
*     ) %&gt;%
    ggplot(
      aes(
*       y = reorder(work_industry, -industry_n),
        x = n, 
        fill = high_gmat
        )
      ) +
    geom_bar(stat = "identity") + 
*   scale_x_continuous(labels = function(x) abs(x)) +
    labs(fill = NULL) + 
    theme_fivethirtyeight() + 
    scale_fill_fivethirtyeight()
```

---
class: inverse, middle, center

# Scatterplots and line plots

---

# &lt;img src="figures/line.png" style="height: 70px"/&gt;

.pull-left[
Line plot: 1 continuous variable + ordinal variable   

- Line plots are suited well to dates, but may work well other ordered variables
- `color` and `linetype` are other arguments you can use when building a line plot

```r
climate %&gt;% 
  group_by(year) %&gt;%
  summarise(uncertainty = mean(uncertainty, na.rm = TRUE)) %&gt;% 
  ggplot(aes(x = year, y = uncertainty)) +
  geom_line()
```
]

.pull-right[
![](index_files/figure-html/unnamed-chunk-5-1.png)&lt;!-- --&gt;
]

---

# &lt;img src="figures/line.png" style="height: 70px"/&gt;

.pull-left[
Line plot: 1 continuous variable + ordinal variable   

- Line plots are suited well to dates, but may work well other ordered variables
- `color` and `linetype` are other arguments you can use when building a line plot

```r
climate %&gt;% 
  group_by(year) %&gt;%
  summarise(uncertainty = mean(uncertainty, na.rm = TRUE)) %&gt;% 
  ggplot(aes(x = year, y = uncertainty)) +
  geom_line()
```
]

.pull-right[
How would you make the line red? 

![](index_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;
]

---

# &lt;img src="figures/scatter.png" style="height: 70px"/&gt;


.pull-left[
Scatterplots: 2 continuous variables 

- When there are a lot of overlapping data, `alpha` is useful
- `color`, `shape`, `size` are other arguments you can use when building a scatter plot

```r
climate %&gt;% 
  ggplot(
    aes(
      x = temp
      , y = uncertainty
      )
    ) + 
  geom_point(alpha = .1)
```
]

.pull-right[
![](index_files/figure-html/unnamed-chunk-7-1.png)&lt;!-- --&gt;
]

---

# &lt;img src="figures/scatter.png" style="height: 70px"/&gt;


.pull-left[
Scatterplots: 2 continuous variables 

- When there are a lot of overlapping data, `alpha` is useful
- `color`, `shape`, `size` are other arguments you can use when building a scatter plot

```r
climate %&gt;% 
  ggplot(
    aes(
      x = temp
      , y = uncertainty
      )
    ) + 
  geom_point(alpha = .1)
```
]

.pull-right[
Take a moment to create scatterplots with (a) `gpa` and `gmat` from `mba` and (b) `year` and `uncertainty` from `climate`
]

---

# Exercise

- With `airbnb`, create a scatterplot that plots two numeric variables  
- In addition to `x` and `y`, include another argument in `aes()`
   - For example, `size`, `shape`, `color` or `alpha`  
- Use `group_by()` and `summarise()` if you would like  
- Feel free to subset your data with `filter` or `sample_n()`

<div class="countdown" id="timer_e303ee9e" data-update-every="1" tabindex="0" style="bottom:0;left:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">07</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

# Exercise

![](index_files/figure-html/unnamed-chunk-9-1.png)&lt;!-- --&gt;

---

# Exercise

```r
airbnb %&gt;% 
  ggplot(aes(x = longitude, y = latitude, color = address)) + 
  geom_point(alpha = .6) + 
  theme_bw() + 
  labs(
    x = 'Longitude'
    , y = 'Latitude'
    , color = 'City'
    , title = 'Coordinates of Seattle-area Airbnbs'
  )
```

---

# Exercise

- With `climate`, create a line plot of mean Fahrenheit temperatures for cities in Brazil
  - Data should be for 1850 and onward ([help](https://gbearden.github.io/r_course_evans_school/slides/part_2/#44))  
  - Use the following formula to convert Celsius to Fahrenheit: `(temp * 9/5) + 32` ([help](https://gbearden.github.io/r_course_evans_school/slides/part_2/#28))  
  - Create the mean temperature with `summarise` and call it `mean_temp` ([help](https://gbearden.github.io/r_course_evans_school/slides/part_3/#33))  
  - Make line color equal to `city`
  - Feel free to change plot aesthetics as you see fit (add a theme; change axis, legend, or plot titles; change the color of lines for cities; etc.)  
  - *Click forward once for a hint on the functions required to prepare the data*  
  - *Click forward twice to see the plot you'll create*

<div class="countdown" id="timer_41262c95" data-update-every="1" tabindex="0" style="bottom:0;left:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">15</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

--

```r
climate %&gt;% 
  filter() %&gt;% 
  mutate() %&gt;% 
  group_by() %&gt;% 
  summarise()
```

---

# Exercise

![](index_files/figure-html/unnamed-chunk-11-1.png)&lt;!-- --&gt;

---

# Exercise

```r
climate %&gt;% 
  filter(country == 'Brazil' &amp; year &gt;= 1850) %&gt;% 
  mutate(temp = (temp * 9/5) + 32) %&gt;% 
  group_by(year, city) %&gt;% 
  summarise(mean_temp = mean(temp, na.rm = TRUE)) %&gt;% 
  ggplot(aes(x = year, y = mean_temp, color = city)) + 
  geom_line(size = 1) + 
  theme_bw() + 
  scale_color_wsj() + 
  labs(
    x = 'Year'
    , y = 'Mean Temperature'
    , title = 'Temperatures in 6 Brazilian Cities, 1850 - present'
    , color = NULL
  )
```

--

How do you add a bar showing the mean temperature for Brazil?

---

class: small

# Exercise 


``` r
brazil_cities &lt;- climate %&gt;% 
  filter(country == 'Brazil' &amp; year &gt;= 1850) %&gt;% 
  mutate(temp = (temp * 9/5) + 32) %&gt;% 
  group_by(year, city) %&gt;% 
  summarise(mean_temp = mean(temp, na.rm = TRUE)) 

*brazil_temp &lt;-
* brazil_cities %&gt;%
* summarise(brazil_temp = mean(mean_temp, na.rm = TRUE))

brazil_cities %&gt;% 
  ggplot(aes(x = year)) + 
* geom_bar(
*   data = brazil_temp,
*   stat = 'identity',
*   aes(y = brazil_temp),
*   alpha = .4,
*   fill = "#76c893"
*   ) +
  geom_line(size = 1, aes(y = mean_temp, color = city)) + 
* coord_cartesian(ylim = c(65, NA)) +
  theme_bw() + 
  scale_color_wsj() + 
  labs(
    x = 'Year'
    , y = 'Mean Temperature'
    , title = 'Temperatures in 6 Brazilian Cities, 1850 - present'
    , color = NULL
  )
```

---

# Setting up VS Code and Github

- Click [here](https://gbearden.github.io/r_course_evans_school/help/vscode/) to set up VS Code and Github
- Open a text file, click on "select a language," and select R
- Connect VS Code and Github

---

# AI Tools in VS Code

- Auto-complete code in an R script
- Inline and side chat
  - Chat modes
  - Models

---
  
# VS Code Agent Mode

Use Agent Mode to:  

- Explore files + ask structured questions
- Request code generation + edits
- Run code or workflows 

**Tips**

- Be specific when asking agents to edit files
- Validate results—agents can be wrong
- Break requests into small steps
- Give permission to perform tasks

**Datasets**

- airbnb. https://bit.ly/3oadz2L
- climate. https://bit.ly/3kKErEb
- mba. https://bit.ly/4evYpeW

---

# VS Code Agent Mode

**Datasets**

- airbnb. https://bit.ly/3oadz2L
- climate. https://bit.ly/3kKErEb
- mba. https://bit.ly/4evYpeW

What analyses would you like for the agent to conduct? Find the best value Airbnb properties? Identify the city with the most stable climate? 

--

**My prompt**

&lt;i&gt;I need to conduct an analysis in R in which I evaluate the data in the climate dataset you can find here: https://bit.ly/3kKErEb. Write the R code in the tidyverse. Perform the following tasks:

- Identify countries where temperature change over time is minimal
- Identify countries where temperature change over time is significant
- Determine whether there is an pattern to the uncertainty in the dataset
- Create data visualizations

Please package the anaysis so that it's ready to share with stakeholder groups.&lt;/i&gt;

---

# VS Code Agent Mode

**Additional Prompts**

Prompt #2  
&lt;i&gt;This code has errors. Are you able to iteratively work through it and identify and fix the errors?&lt;/i&gt;  

Prompt #3  
&lt;i&gt;When creating country_trends, it throws the error:  
&lt;br&gt;
Error in group_by():  
! Must group by variables found in .data.  
✖ Column Country is not found.&lt;/i&gt;  

Prompt #4  
&lt;i&gt;Really nice job, thank you. Please add code to the script to recommend a few countries where I should consider moving given that I prefer warm temperatures and climate stability.&lt;/i&gt;  

Prompt #5  
&lt;i&gt;You put the code at the top of the script. Could you append it to the bottom?&lt;/i&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
  "highlightStyle": "github",
  "highlightLines": true,
  "countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
